<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Afrobeat Football Club - Awards 2025 | Official Voting Portal</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1B5E20;
            --primary-light: #2E7D32;
            --primary-dark: #0D4F17;
            --accent: #FF6B35;
            --accent-light: #FF8A65;
            --gold: #FFD700;
            --gold-dark: #FFC107;
            --dark: #0A0A0A;
            --dark-light: #1A1A1A;
            --light: #F8FAFC;
            --light-gray: #F1F5F9;
            --white: #FFFFFF;
            --text-primary: #0F172A;
            --text-secondary: #475569;
            --text-muted: #64748B;
            --border: #E2E8F0;
            --border-light: #F1F5F9;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --gradient-primary: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent) 0%, var(--gold) 100%);
            --gradient-hero: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 50%, var(--primary-light) 100%);
            --border-radius: 8px;
            --border-radius-lg: 12px;
            --border-radius-xl: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: var(--light);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: 16px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1440px;
            margin: 0 auto;
            background: var(--white);
            min-height: 100vh;
            box-shadow: var(--shadow-xl);
            position: relative;
        }

        /* Modern Header */
        .header {
            background: var(--gradient-hero);
            color: var(--white);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 107, 53, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .header-nav {
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            position: relative;
            z-index: 2;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            font-size: 0.9rem;
            letter-spacing: 0.025em;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .admin-link {
            background: rgba(255, 255, 255, 0.15);
            color: var(--white);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 500;
            transition: var(--transition);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .admin-link:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-1px);
        }

        .header-main {
            padding: 4rem 2rem;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        /* ABFC Logo SVG */
        .club-logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 2rem;
            filter: drop-shadow(0 4px 20px rgba(0, 0, 0, 0.2));
        }

        .club-name {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 900;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
            background: linear-gradient(135deg, var(--white) 0%, var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .club-full-name {
            font-size: clamp(1.125rem, 2.5vw, 1.5rem);
            font-weight: 300;
            opacity: 0.9;
            margin-bottom: 0.75rem;
            letter-spacing: 0.05em;
        }

        .club-tagline {
            font-size: clamp(1rem, 2vw, 1.25rem);
            font-weight: 500;
            opacity: 0.8;
            margin-bottom: 2rem;
            letter-spacing: 0.025em;
        }

        .awards-badge {
            background: var(--gradient-accent);
            color: var(--dark);
            padding: 0.875rem 2rem;
            border-radius: 50px;
            font-size: 1.125rem;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
            border: 2px solid var(--white);
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        /* Navigation Breadcrumb */
        .breadcrumb {
            background: var(--white);
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            display: none;
        }

        .breadcrumb.show {
            display: block;
        }

        .breadcrumb-nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .breadcrumb-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .breadcrumb-separator {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        /* Modern Progress Section */
        .progress-section {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 2rem;
            display: none;
        }

        .progress-section.show {
            display: block;
        }

        .progress-container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .progress-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            opacity: 0.95;
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .progress-stat {
            text-align: center;
        }

        .progress-number {
            font-size: 2.5rem;
            font-weight: 800;
            display: block;
            background: linear-gradient(135deg, var(--white) 0%, var(--gold) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .progress-label {
            font-size: 0.875rem;
            font-weight: 500;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.075em;
        }

        .progress-bar-wrapper {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            height: 16px;
            overflow: hidden;
            max-width: 500px;
            margin: 0 auto;
            backdrop-filter: blur(10px);
        }

        .progress-bar {
            background: var(--gradient-accent);
            height: 100%;
            border-radius: 50px;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Main Content Layout */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        /* Welcome Section - Modern Design */
        .welcome-section {
            text-align: center;
            max-width: 800px;
            margin: 0 auto 4rem;
        }

        .welcome-hero {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 4rem 3rem;
            border-radius: var(--border-radius-xl);
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .welcome-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 70%, rgba(255, 107, 53, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(255, 215, 0, 0.15) 0%, transparent 50%);
            pointer-events: none;
        }

        .welcome-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
        }

        .welcome-title {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 800;
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            position: relative;
            z-index: 1;
        }

        .welcome-subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            line-height: 1.7;
            margin-bottom: 2.5rem;
            position: relative;
            z-index: 1;
        }

        .cta-button {
            background: var(--gradient-accent);
            color: var(--dark);
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.125rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 1;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(255, 107, 53, 0.5);
        }

        /* Modern Card Designs */
        .card {
            background: var(--white);
            border-radius: var(--border-radius-xl);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            overflow: hidden;
            position: relative;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        /* Voter Information Card */
        .voter-card {
            margin-bottom: 3rem;
            display: none;
        }

        .voter-card.show {
            display: block;
        }

        .card-header {
            padding: 2rem 2.5rem 1.5rem;
            border-bottom: 1px solid var(--border-light);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.5rem;
        }

        .card-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .card-body {
            padding: 2.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .form-group {
            position: relative;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .form-input {
            width: 100%;
            padding: 1rem 1.25rem;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: var(--border-radius);
            background: var(--light);
            transition: var(--transition);
            font-family: inherit;
            color: var(--text-primary);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--white);
            box-shadow: 0 0 0 3px rgba(27, 94, 32, 0.1);
            transform: translateY(-1px);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        /* Voting Section */
        .voting-section {
            display: none;
        }

        .voting-section.show {
            display: block;
        }

        .category-card {
            margin-bottom: 3rem;
        }

        .category-header {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 3rem 2.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .category-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 75%, rgba(255, 107, 53, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 75% 25%, rgba(255, 215, 0, 0.15) 0%, transparent 50%);
            pointer-events: none;
        }

        .category-counter {
            font-size: 0.875rem;
            font-weight: 600;
            opacity: 0.8;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            position: relative;
            z-index: 1;
        }

        .category-title {
            font-size: clamp(1.875rem, 4vw, 2.5rem);
            font-weight: 800;
            margin-bottom: 1.5rem;
            letter-spacing: -0.02em;
            position: relative;
            z-index: 1;
        }

        .category-description {
            font-size: 1.125rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            position: relative;
            z-index: 1;
        }

        .voting-input-section {
            padding: 3rem 2.5rem;
            text-align: center;
        }

        .voting-input {
            width: 100%;
            max-width: 500px;
            padding: 1.5rem 2rem;
            font-size: 1.25rem;
            font-weight: 500;
            border: 3px solid var(--border);
            border-radius: var(--border-radius-lg);
            background: var(--light);
            transition: var(--transition);
            font-family: inherit;
            color: var(--text-primary);
            text-align: center;
        }

        .voting-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--white);
            box-shadow: 0 0 0 4px rgba(27, 94, 32, 0.15);
            transform: translateY(-2px);
        }

        .save-indicator {
            margin-top: 1rem;
            font-size: 0.875rem;
            color: var(--success);
            opacity: 0;
            transition: var(--transition);
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .save-indicator.show {
            opacity: 1;
        }

        /* Navigation Controls */
        .navigation-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1.5rem;
            margin-top: 3rem;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            min-width: 150px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            position: relative;
            overflow: hidden;
        }

        .nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s ease;
        }

        .nav-button:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: var(--white);
            box-shadow: 0 4px 15px rgba(27, 94, 32, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(27, 94, 32, 0.4);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--text-secondary);
            border: 2px solid var(--border);
            box-shadow: var(--shadow);
        }

        .btn-secondary:hover {
            background: var(--light);
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--gradient-accent);
            color: var(--dark);
            box-shadow: 0 4px 15px rgba(255, 107, 53, 0.3);
            font-weight: 700;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 53, 0.4);
        }

        /* Success Section */
        .success-section {
            display: none;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .success-section.show {
            display: block;
        }

        .success-hero {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 4rem 3rem;
            border-radius: var(--border-radius-xl);
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }

        .success-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 70%, rgba(16, 185, 129, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 70% 30%, rgba(255, 215, 0, 0.15) 0%, transparent 50%);
            pointer-events: none;
        }

        .success-icon {
            font-size: 5rem;
            margin-bottom: 1.5rem;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
        }

        .success-title {
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 800;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .success-subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            line-height: 1.7;
            position: relative;
            z-index: 1;
        }

        /* Sharing Section */
        .sharing-section {
            background: var(--light-gray);
            border-radius: var(--border-radius-xl);
            padding: 3rem 2rem;
            margin: 3rem 0;
            text-align: center;
            border: 1px solid var(--border-light);
        }

        .sharing-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .sharing-subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        .sharing-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .share-button {
            background: var(--white);
            color: var(--text-primary);
            border: 2px solid var(--border);
            padding: 1rem 2rem;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: var(--shadow);
        }

        .share-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .share-button.whatsapp {
            border-color: #25D366;
            color: #25D366;
        }

        .share-button.whatsapp:hover {
            background: #25D366;
            color: var(--white);
        }

        .share-button.copy {
            border-color: var(--primary);
            color: var(--primary);
        }

        .share-button.copy:hover {
            background: var(--primary);
            color: var(--white);
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
            margin: 2rem;
            margin-bottom: 4rem;
        }

        .admin-panel.show {
            display: block;
        }

        .admin-header {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 2.5rem;
            text-align: center;
            border-radius: var(--border-radius-xl) var(--border-radius-xl) 0 0;
            position: relative;
            overflow: hidden;
        }

        .admin-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 75%, rgba(255, 107, 53, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 75% 25%, rgba(255, 215, 0, 0.15) 0%, transparent 50%);
            pointer-events: none;
        }

        .admin-title {
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        .admin-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .admin-body {
            background: var(--white);
            padding: 2.5rem;
            border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
            border: 1px solid var(--border);
            border-top: none;
        }

        .admin-section {
            margin-bottom: 3rem;
        }

        .admin-section:last-child {
            margin-bottom: 0;
        }

        .admin-section-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .google-sheets-card {
            background: var(--light);
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            border: 1px solid var(--border-light);
        }

        .sheets-input {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border);
            border-radius: var(--border-radius);
            font-size: 0.875rem;
            margin-bottom: 1rem;
            font-family: 'JetBrains Mono', monospace;
            background: var(--white);
        }

        .sheets-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(27, 94, 32, 0.1);
        }

        .sheets-status {
            margin-top: 1rem;
            font-size: 0.875rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .admin-button {
            background: var(--white);
            border: 2px solid var(--border);
            color: var(--text-primary);
            padding: 1rem 1.25rem;
            border-radius: var(--border-radius-lg);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            text-align: center;
        }

        .admin-button:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-lg);
        }

        .admin-button.info { border-color: #3B82F6; color: #3B82F6; }
        .admin-button.info:hover { background: #3B82F6; color: var(--white); }

        .admin-button.warning { border-color: var(--warning); color: #D97706; }
        .admin-button.warning:hover { background: var(--warning); color: var(--white); }

        .admin-button.danger { border-color: var(--danger); color: var(--danger); }
        .admin-button.danger:hover { background: var(--danger); color: var(--white); }

        /* Results Display */
        .results-display {
            display: none;
            margin: 3rem 2rem;
        }

        .results-display.show {
            display: block;
        }

        .results-header {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 2rem;
            text-align: center;
            border-radius: var(--border-radius-xl) var(--border-radius-xl) 0 0;
        }

        .results-title {
            font-size: 1.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .results-content {
            background: var(--white);
            padding: 2rem;
            border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
            border: 1px solid var(--border);
            border-top: none;
            font-family: 'JetBrains Mono', 'SF Mono', 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
            color: var(--text-primary);
            background: var(--light-gray);
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--white);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius-lg);
            font-weight: 600;
            font-size: 0.875rem;
            box-shadow: var(--shadow-xl);
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: var(--transition);
            border-left: 4px solid var(--success);
            max-width: 350px;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .toast.error { border-left-color: var(--danger); }
        .toast.warning { border-left-color: var(--warning); }
        .toast.success { border-left-color: var(--success); }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .header-nav {
                padding: 0.75rem 1.5rem;
            }
            
            .header-main {
                padding: 3rem 1.5rem;
            }
            
            .main-content {
                padding: 2rem 1.5rem;
            }
        }

        @media (max-width: 768px) {
            :root {
                font-size: 14px;
            }
            
            .header-nav {
                padding: 0.75rem 1rem;
            }
            
            .nav-brand {
                font-size: 0.8rem;
            }
            
            .admin-link {
                padding: 0.375rem 0.75rem;
                font-size: 0.8rem;
            }
            
            .header-main {
                padding: 2rem 1rem;
            }
            
            .club-logo {
                width: 80px;
                height: 80px;
            }
            
            .main-content {
                padding: 1.5rem 1rem;
            }
            
            .welcome-hero,
            .success-hero {
                padding: 2.5rem 2rem;
            }
            
            .card-header,
            .card-body,
            .voting-input-section,
            .category-header {
                padding: 2rem 1.5rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .navigation-controls {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-button {
                width: 100%;
                max-width: 280px;
            }
            
            .sharing-buttons {
                flex-direction: column;
                align-items: center;
                max-width: 280px;
                margin: 0 auto;
            }
            
            .share-button {
                width: 100%;
                justify-content: center;
            }
            
            .progress-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .admin-actions {
                grid-template-columns: 1fr;
            }
            
            .admin-panel {
                margin: 1rem;
            }
            
            .toast {
                top: 1rem;
                right: 1rem;
                left: 1rem;
                transform: translateY(-100%);
                max-width: none;
            }
            
            .toast.show {
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .welcome-hero,
            .success-hero,
            .category-header {
                padding: 2rem 1.5rem;
            }
            
            .card-body,
            .voting-input-section {
                padding: 1.5rem;
            }
            
            .progress-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading States */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: currentColor;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Smooth Scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Focus Styles */
        *:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        button:focus,
        .nav-button:focus,
        .admin-button:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* Keyboard shortcut styling */
        kbd {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 0.2em 0.4em;
            font-size: 0.8em;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-primary);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Modern Header -->
        <header class="header">
            <nav class="header-nav">
                <div class="nav-brand">
                    <i class="fas fa-calendar-alt"></i>
                    <span>Season 2025</span>
                    <span>•</span>
                    <i class="fas fa-shield-alt"></i>
                    <span>Official Portal</span>
                </div>
                <div class="nav-actions">
                    <a href="#admin" class="admin-link" onclick="toggleAdmin(event)">
                        <i class="fas fa-cog"></i> Admin Portal
                    </a>
                </div>
            </nav>
            
            <div class="header-main">
                <!-- ABFC Logo SVG -->
                <svg class="club-logo" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Outer Circle -->
                    <circle cx="100" cy="100" r="95" fill="none" stroke="#FFD700" stroke-width="4"/>
                    
                    <!-- Soccer Ball -->
                    <circle cx="100" cy="100" r="45" fill="#FFFFFF" stroke="#1B5E20" stroke-width="3"/>
                    
                    <!-- Soccer Ball Pattern -->
                    <g stroke="#1B5E20" stroke-width="2" fill="none">
                        <!-- Pentagon in center -->
                        <polygon points="100,70 115,82 109,102 91,102 85,82" fill="#1B5E20"/>
                        
                        <!-- Hexagonal pattern -->
                        <path d="M100,55 L115,67 L109,87 L91,87 L85,67 Z"/>
                        <path d="M85,67 L100,55 L115,67 L130,75 L125,95 L109,87 Z"/>
                        <path d="M115,67 L130,75 L145,67 L140,87 L125,95 L109,87 Z"/>
                        <path d="M70,75 L85,67 L100,55 L85,47 L70,55 L75,75 Z"/>
                        <path d="M85,82 L91,102 L75,110 L60,102 L66,82 L75,75 Z"/>
                        <path d="M115,82 L109,102 L125,110 L140,102 L134,82 L125,95 Z"/>
                    </g>
                    
                    <!-- ABFC Letters around the circle -->
                    <g fill="#FF6B35" font-family="Inter, sans-serif" font-weight="900" font-size="32">
                        <!-- A at top -->
                        <text x="100" y="25" text-anchor="middle" dominant-baseline="central">A</text>
                        <!-- B at right -->
                        <text x="175" y="100" text-anchor="middle" dominant-baseline="central">B</text>
                        <!-- F at bottom -->
                        <text x="100" y="185" text-anchor="middle" dominant-baseline="central">F</text>
                        <!-- C at left -->
                        <text x="25" y="100" text-anchor="middle" dominant-baseline="central">C</text>
                    </g>
                    
                    <!-- Decorative elements -->
                    <g fill="#FFD700">
                        <circle cx="60" cy="40" r="3"/>
                        <circle cx="140" cy="40" r="3"/>
                        <circle cx="160" cy="160" r="3"/>
                        <circle cx="40" cy="160" r="3"/>
                    </g>
                </svg>
                
                <h1 class="club-name">ABFC</h1>
                <p class="club-full-name">Afrobeat Football Club</p>
                <p class="club-tagline">Excellence • Unity • Victory</p>
                <div class="awards-badge">
                    <i class="fas fa-trophy"></i>
                    2025 Awards Voting
                </div>
            </div>
        </header>

        <!-- Breadcrumb Navigation -->
        <nav class="breadcrumb" id="breadcrumb">
            <div class="breadcrumb-nav">
                <div class="breadcrumb-item">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </div>
                <i class="fas fa-chevron-right breadcrumb-separator"></i>
                <div class="breadcrumb-item">
                    <i class="fas fa-vote-yea"></i>
                    <span id="breadcrumbText">Voting</span>
                </div>
            </div>
        </nav>

        <!-- Progress Section -->
        <section class="progress-section" id="progressSection">
            <div class="progress-container">
                <h3 class="progress-title">Your Voting Progress</h3>
                <div class="progress-grid">
                    <div class="progress-stat">
                        <span class="progress-number" id="completedCount">0</span>
                        <span class="progress-label">Completed</span>
                    </div>
                    <div class="progress-stat">
                        <span class="progress-number" id="remainingCount">9</span>
                        <span class="progress-label">Remaining</span>
                    </div>
                    <div class="progress-stat">
                        <span class="progress-number" id="progressPercentage">0%</span>
                        <span class="progress-label">Progress</span>
                    </div>
                </div>
                <div class="progress-bar-wrapper">
                    <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                </div>
            </div>
        </section>

        <!-- Admin Panel -->
        <div class="admin-panel card" id="adminPanel">
            <!-- Admin Login Screen -->
            <div class="admin-login" id="adminLogin">
                <div class="admin-header">
                    <h2 class="admin-title">
                        <i class="fas fa-lock"></i> Admin Access Required
                    </h2>
                    <p class="admin-subtitle">Enter the admin passcode to access system controls</p>
                </div>
                <div class="admin-body">
                    <div style="max-width: 400px; margin: 0 auto;">
                        <div class="form-group">
                            <label class="form-label" for="adminPasscode">
                                <i class="fas fa-key"></i> Admin Passcode
                            </label>
                            <input type="password" class="form-input" id="adminPasscode" 
                                   placeholder="Enter admin passcode" 
                                   style="text-align: center; font-size: 1.2em; font-weight: 600;">
                            <div style="font-size: 0.875rem; color: var(--text-muted); margin-top: 0.5rem; text-align: center;">
                                Contact ABFC administrator for access
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                            <button class="nav-button btn-primary" onclick="verifyAdminAccess()" style="flex: 1;">
                                <i class="fas fa-unlock"></i> Access Admin Panel
                            </button>
                            <button class="nav-button btn-secondary" onclick="closeAdminPanel()" style="flex: 1;">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        </div>
                        
                        <div id="adminLoginError" style="display: none; margin-top: 1rem; padding: 1rem; background: rgba(239, 68, 68, 0.1); border: 1px solid var(--danger); border-radius: 8px; color: var(--danger); text-align: center; font-weight: 600;">
                            <i class="fas fa-exclamation-triangle"></i> Incorrect passcode. Access denied.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Dashboard (Hidden until authenticated) -->
            <div class="admin-dashboard" id="adminDashboard" style="display: none;">
                <div class="admin-header">
                    <h2 class="admin-title">
                        <i class="fas fa-shield-alt"></i> Admin Dashboard
                    </h2>
                    <p class="admin-subtitle">Manage the Afrobeat Football Club Awards voting system</p>
                    <button onclick="logoutAdmin()" style="position: absolute; top: 1rem; right: 1rem; background: rgba(255,255,255,0.2); border: none; color: white; padding: 0.5rem 1rem; border-radius: 20px; cursor: pointer; font-size: 0.8rem;">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
                
                <div class="admin-body">
                    <!-- Duplicate Detection Section -->
                    <div class="admin-section" style="background: #fef3c7; border: 2px solid #fbbf24; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
                        <h3 style="color: #92400e; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-exclamation-triangle"></i> Duplicate Vote Detection
                        </h3>
                        <p style="color: #78350f; margin-bottom: 1rem; font-size: 0.9rem;">
                            <strong>Total Votes in System:</strong> <span id="totalVotesCount">0</span><br>
                            <strong>Potential Duplicates:</strong> <span id="duplicateCount" style="color: var(--danger); font-weight: 700;">0</span>
                        </p>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button class="admin-button warning" onclick="checkForDuplicates()">
                                <i class="fas fa-search"></i> Scan for Duplicates
                            </button>
                            <button class="admin-button danger" onclick="removeDuplicates()">
                                <i class="fas fa-broom"></i> Remove Duplicates
                            </button>
                        </div>
                        <div id="duplicateResults" style="display: none; margin-top: 1rem; padding: 1rem; background: white; border-radius: 8px; font-family: monospace; font-size: 0.8em; max-height: 200px; overflow-y: auto;">
                        </div>
                    </div>

                    <!-- EMERGENCY RESET SECTION - Always visible -->
                    <div class="admin-section" style="background: #fee2e2; border: 2px solid #fecaca; border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
                        <h3 style="color: #dc2626; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-exclamation-triangle"></i> Emergency Reset
                        </h3>
                        <p style="color: #7f1d1d; margin-bottom: 1rem; font-size: 0.9rem;">
                            If you're stuck with "already voted" message, use these buttons:
                        </p>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button class="nav-button btn-primary" onclick="forceResetNow()" style="background: #dc2626;">
                                <i class="fas fa-redo"></i> FORCE RESET NOW
                            </button>
                            <button class="nav-button btn-secondary" onclick="emergencyWipe()">
                                <i class="fas fa-bomb"></i> EMERGENCY WIPE
                            </button>
                        </div>
                    </div>

                    <div class="admin-section">
                        <h3 class="admin-section-title">
                            <i class="fas fa-table"></i> Google Sheets Integration
                        </h3>
                        <div class="google-sheets-card">
                            <input type="text" class="sheets-input" id="googleSheetUrl" 
                                   placeholder="https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"
                                   value="https://script.google.com/macros/s/AKfycbwn3z_zCDQih8zdN2quKvX9Brhew_sbyR8DBVvhFe9Z05XhSDRKJhH8b_h4YeTEchhx2w/exec">
                            <button class="nav-button btn-primary" onclick="saveGoogleSheetUrl()">
                                <i class="fas fa-save"></i> Save Configuration
                            </button>
                            <div class="sheets-status" id="sheetStatus">
                                <i class="fas fa-check-circle"></i> 
                                Google Sheets connected and ready
                            </div>
                        </div>
                    </div>

                    <div class="admin-section">
                        <h3 class="admin-section-title">
                            <i class="fas fa-tools"></i> System Controls
                        </h3>
                        <div style="background: var(--light-gray); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                            <strong>🎯 Testing Shortcuts:</strong><br>
                            • <kbd>Ctrl+Shift+R</kbd> - Quick Reset for Testing<br>
                            • <kbd>Ctrl+Shift+C</kbd> - Emergency Clear All<br>
                            • <kbd>Ctrl+Shift+A</kbd> - Toggle Admin Panel
                        </div>
                        <div class="admin-actions">
                            <button class="admin-button info" onclick="exportData()">
                                <i class="fas fa-download"></i> Export CSV
                            </button>
                            <button class="admin-button info" onclick="viewAllResults()">
                                <i class="fas fa-chart-bar"></i> View Results
                            </button>
                            <button class="admin-button warning" onclick="resetForTesting()">
                                <i class="fas fa-redo"></i> Reset for Testing
                            </button>
                            <button class="admin-button warning" onclick="toggleVotingStatus()" id="votingToggle">
                                <i class="fas fa-ban"></i> Close Voting
                            </button>
                            <button class="admin-button danger" onclick="clearAllData()">
                                <i class="fas fa-trash"></i> Clear All Data
                            </button>
                            <button class="admin-button danger" onclick="emergencyClear()">
                                <i class="fas fa-bomb"></i> Emergency Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Welcome Section -->
            <section class="welcome-section" id="welcomeSection">
                <div class="welcome-hero">
                    <div class="welcome-icon">🏆</div>
                    <h2 class="welcome-title">Cast Your Vote for Excellence</h2>
                    <p class="welcome-subtitle">
                        Join us in celebrating the outstanding performances and contributions of our Afrobeat Football Club family. 
                        Vote across 9 prestigious categories and help us honor the best of our club.
                    </p>
                    <button class="cta-button" onclick="startVoting()">
                        <i class="fas fa-play"></i>
                        Begin Voting Process
                    </button>
                </div>
                
                <!-- Quick Reset Option - Always visible for testing -->
                <div style="text-align: center; margin-top: 2rem; padding: 1.5rem; background: rgba(220, 38, 38, 0.1); border-radius: 12px; border: 1px solid rgba(220, 38, 38, 0.2);">
                    <p style="color: #7f1d1d; margin-bottom: 1rem; font-weight: 500;">
                        🧪 <strong>For Testing:</strong> If you're seeing "already voted" messages, click here:
                    </p>
                    <button class="nav-button" onclick="forceResetNow()" style="background: #dc2626; color: white; border: none;">
                        <i class="fas fa-redo"></i>
                        Reset Voting Status
                    </button>
                </div>
            </section>

            <!-- Voter Information Card -->
            <section class="voter-card card" id="voterCard">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="fas fa-user-circle"></i>
                        Voter Registration
                    </h3>
                    <p class="card-subtitle">
                        <strong style="color: var(--danger);">⚠️ ALL FIELDS ARE MANDATORY</strong> - Please provide complete information to proceed with voting
                    </p>
                </div>
                <div class="card-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label" for="voterName" style="color: var(--danger); font-weight: 700;">
                                <i class="fas fa-signature"></i> Full Name *
                                <span style="font-size: 0.8em; color: var(--danger);">(REQUIRED)</span>
                            </label>
                            <input type="text" class="form-input" id="voterName" 
                                   placeholder="Enter your complete full name" required
                                   style="border-color: var(--danger); border-width: 3px;">
                            <div class="validation-message" id="nameValidation" style="display: none; color: var(--danger); font-size: 0.875rem; margin-top: 0.5rem; font-weight: 600;">
                                <i class="fas fa-exclamation-circle"></i> Full name is required to proceed
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="voterEmail" style="color: var(--danger); font-weight: 700;">
                                <i class="fas fa-envelope"></i> Email Address *
                                <span style="font-size: 0.8em; color: var(--danger);">(REQUIRED)</span>
                            </label>
                            <input type="email" class="form-input" id="voterEmail" 
                                   placeholder="your.email@example.com" required
                                   style="border-color: var(--danger); border-width: 3px;">
                            <div class="validation-message" id="emailValidation" style="display: none; color: var(--danger); font-size: 0.875rem; margin-top: 0.5rem; font-weight: 600;">
                                <i class="fas fa-exclamation-circle"></i> Valid email address is required
                            </div>
                        </div>
                    </div>
                    
                    <!-- Requirements Notice -->
                    <div style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.1)); border: 2px solid var(--danger); border-radius: 12px; padding: 1.5rem; margin: 1.5rem 0;">
                        <h4 style="color: var(--danger); margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-exclamation-triangle"></i> MANDATORY INFORMATION REQUIRED
                        </h4>
                        <ul style="color: var(--danger); font-weight: 600; margin-left: 1rem;">
                            <li>✅ <strong>Full Name:</strong> Must be your complete real name</li>
                            <li>✅ <strong>Email Address:</strong> Must be a valid email address</li>
                            <li>⚠️ <strong>Both fields are required</strong> - You cannot proceed without completing them</li>
                            <li>🔒 <strong>Your information is secure</strong> and only used for voting verification</li>
                        </ul>
                    </div>
                    
                    <div class="navigation-controls">
                        <button class="nav-button btn-primary" id="proceedBtn" onclick="proceedToVoting()" disabled 
                                style="opacity: 0.5; cursor: not-allowed;">
                            <i class="fas fa-lock"></i>
                            Complete Required Fields First
                        </button>
                    </div>
                </div>
            </section>

            <!-- Voting Section -->
            <section class="voting-section" id="votingSection">
                <div class="category-card card">
                    <div class="category-header">
                        <div class="category-counter" id="categoryCounter">Category 1 of 9</div>
                        <h2 class="category-title" id="categoryTitle">
                            <i class="fas fa-hand-paper"></i> Best Goalkeeper
                        </h2>
                        <p class="category-description" id="categoryDescription">
                            Vote for the goalkeeper who demonstrated exceptional skill, consistency, and leadership throughout the season.
                        </p>
                    </div>

                    <div class="voting-input-section">
                        <input type="text" class="voting-input" id="votingInput" 
                               placeholder="Enter the player's name">
                        <div class="save-indicator" id="saveIndicator">
                            <i class="fas fa-check-circle"></i>
                            Vote saved automatically
                        </div>
                    </div>
                </div>

                <div class="navigation-controls">
                    <button class="nav-button btn-secondary" id="prevButton" 
                            onclick="previousCategory()" style="display: none;">
                        <i class="fas fa-arrow-left"></i>
                        Previous
                    </button>
                    <button class="nav-button btn-primary" id="nextButton" onclick="nextCategory()">
                        <i class="fas fa-arrow-right"></i>
                        Next Category
                    </button>
                </div>
            </section>

            <!-- Success Section -->
            <section class="success-section" id="successSection">
                <div class="success-hero">
                    <div class="success-icon">🎉</div>
                    <h2 class="success-title">Vote Submitted Successfully!</h2>
                    <p class="success-subtitle">
                        Thank you for participating in the Afrobeat Football Club Awards 2025. Your votes have been recorded 
                        and will contribute to celebrating our club's finest achievements this season.
                    </p>
                </div>
                
                <div class="navigation-controls">
                    <button class="nav-button btn-success" onclick="shareResults()">
                        <i class="fas fa-share-alt"></i>
                        Share Results
                    </button>
                    <button class="nav-button btn-primary" onclick="viewResults()">
                        <i class="fas fa-chart-line"></i>
                        View Current Results
                    </button>
                </div>
            </section>

            <!-- Sharing Section -->
            <section class="sharing-section">
                <h3 class="sharing-title">
                    <i class="fas fa-bullhorn"></i> Share ABFC Awards
                </h3>
                <p class="sharing-subtitle">Help spread the word about our club awards voting</p>
                <div class="sharing-buttons">
                    <button class="share-button whatsapp" onclick="shareWhatsApp()">
                        <i class="fab fa-whatsapp"></i>
                        Share on WhatsApp
                    </button>
                    <button class="share-button copy" onclick="copyLink()">
                        <i class="fas fa-link"></i>
                        Copy Voting Link
                    </button>
                </div>
            </section>
        </main>

        <!-- Results Display -->
        <div class="results-display card" id="resultsDisplay">
            <div class="results-header">
                <h3 class="results-title">
                    <i class="fas fa-poll-h"></i>
                    Live Voting Results
                </h3>
            </div>
            <div class="results-content" id="resultsContent"></div>
        </div>
    </div>

    <script>
        // Configuration
        let GOOGLE_SHEET_URL = localStorage.getItem('abfc_google_sheet_url') || 'https://script.google.com/macros/s/AKfycbwn3z_zCDQih8zdN2quKvX9Brhew_sbyR8DBVvhFe9Z05XhSDRKJhH8b_h4YeTEchhx2w/exec';
        
        // Admin Configuration
        const ADMIN_PASSCODE = 'ABFC2025'; // Change this to your desired passcode
        let isAdminAuthenticated = false;
        
        // App State
        let currentCategory = 0;
        let votes = {};
        let voterInfo = {};
        let allVotes = [];
        let votingEnabled = true;
        let hasVoted = false;
        let currentSection = 'welcome';

        // Updated Categories Configuration (9 categories)
        const categories = [
            { 
                title: 'Best Goalkeeper', 
                description: 'Vote for the goalkeeper who demonstrated exceptional skill, consistency, and leadership throughout the season.',
                icon: 'fas fa-hand-paper'
            },
            { 
                title: 'Best Defender', 
                description: 'Recognize the defender who showed outstanding defensive skills, tactical awareness, and team protection.',
                icon: 'fas fa-shield-alt'
            },
            { 
                title: 'Best Midfielder', 
                description: 'Honor the midfielder who controlled the game with exceptional passing, creativity, and field vision.',
                icon: 'fas fa-running'
            },
            { 
                title: 'Best Striker', 
                description: 'Celebrate the striker who consistently found the back of the net and led our attacking force.',
                icon: 'fas fa-crosshairs'
            },
            { 
                title: 'Best Winger', 
                description: 'Vote for the winger who provided pace, skill, and creativity on the flanks throughout the season.',
                icon: 'fas fa-plane'
            },
            { 
                title: 'Best Utility Player', 
                description: 'Vote for the most versatile player who excelled in multiple positions and situations.',
                icon: 'fas fa-exchange-alt'
            },
            { 
                title: 'Most Improved Player', 
                description: 'Celebrate the player who showed remarkable growth and development this season.',
                icon: 'fas fa-chart-line'
            },
            { 
                title: 'Best Behaved Player', 
                description: 'Honor the player who exemplified sportsmanship, discipline, and respect on and off the field.',
                icon: 'fas fa-medal'
            },
            { 
                title: 'Most Frequent Player', 
                description: 'Vote for the most active and engaged player across all club activities and social media.',
                icon: 'fas fa-calendar-check'
            }
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadStoredData();
            setupEventListeners();
            updateGoogleSheetsStatus();
            updateRemainingCount();
            
            // Check for existing admin session
            if (localStorage.getItem('abfc_admin_session') === 'true') {
                isAdminAuthenticated = true;
            }
            
            // Auto-save the Google Sheets URL if not already saved
            if (!localStorage.getItem('abfc_google_sheet_url')) {
                localStorage.setItem('abfc_google_sheet_url', GOOGLE_SHEET_URL);
            }
            
            // Check voting status after everything loads
            setTimeout(() => {
                checkVotingStatus();
                
                // If user has voted, automatically show admin panel for easy reset
                if (hasVoted) {
                    console.log('🔧 Previous vote detected - showing admin panel for easy reset');
                    if (isAdminAuthenticated) {
                        document.getElementById('adminLogin').style.display = 'none';
                        document.getElementById('adminDashboard').style.display = 'block';
                    }
                    document.getElementById('adminPanel').classList.add('show');
                    showToast('⚠️ Previous vote detected! Use admin panel to reset for testing.', 'warning');
                }
            }, 500);
        });

        function setupEventListeners() {
            // Auto-save voting input
            document.getElementById('votingInput').addEventListener('input', function() {
                const value = this.value.trim();
                if (value) {
                    votes[currentCategory] = value;
                    localStorage.setItem('abfc_individual_votes', JSON.stringify(votes));
                    showSaveIndicator();
                    updateProgress();
                }
            });

            // Strict voter information validation
            ['voterName', 'voterEmail'].forEach(id => {
                const field = document.getElementById(id);
                
                // Real-time validation on input
                field.addEventListener('input', function() {
                    voterInfo[id] = this.value.trim();
                    localStorage.setItem('abfc_voter_info', JSON.stringify(voterInfo));
                    validateVoterForm();
                });
                
                // Validation on blur (when field loses focus)
                field.addEventListener('blur', function() {
                    validateIndividualField(id);
                });
                
                // Clear validation on focus
                field.addEventListener('focus', function() {
                    clearFieldValidation(id);
                });
            });

            // Handle Enter key in voting input
            document.getElementById('votingInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    if (this.value.trim()) {
                        nextCategory();
                    }
                }
            });

            // Handle Enter key in admin password field
            document.getElementById('adminPasscode').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    verifyAdminAccess();
                }
            });

            // Admin keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                // Ctrl+Shift+R = Quick Reset for Testing (admin only)
                if (e.ctrlKey && e.shiftKey && e.key === 'R' && isAdminAuthenticated) {
                    e.preventDefault();
                    resetForTesting();
                }
                
                // Ctrl+Shift+C = Emergency Clear (admin only)
                if (e.ctrlKey && e.shiftKey && e.key === 'C' && isAdminAuthenticated) {
                    e.preventDefault();
                    emergencyClear();
                }
                
                // Ctrl+Shift+A = Toggle Admin Panel
                if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                    e.preventDefault();
                    const panel = document.getElementById('adminPanel');
                    panel.classList.toggle('show');
                    if (panel.classList.contains('show')) {
                        if (isAdminAuthenticated) {
                            document.getElementById('adminLogin').style.display = 'none';
                            document.getElementById('adminDashboard').style.display = 'block';
                            updateDuplicateStats();
                        } else {
                            document.getElementById('adminLogin').style.display = 'block';
                            document.getElementById('adminDashboard').style.display = 'none';
                            setTimeout(() => {
                                document.getElementById('adminPasscode').focus();
                            }, 300);
                        }
                        panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }
            });
        }

        // Voter Form Validation Functions
        function validateVoterForm() {
            const name = document.getElementById('voterName').value.trim();
            const email = document.getElementById('voterEmail').value.trim();
            const proceedBtn = document.getElementById('proceedBtn');
            
            const isNameValid = name.length >= 2 && name.includes(' '); // Must be at least 2 chars and include space for full name
            const isEmailValid = email && /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
            
            if (isNameValid && isEmailValid) {
                // Enable proceed button
                proceedBtn.disabled = false;
                proceedBtn.style.opacity = '1';
                proceedBtn.style.cursor = 'pointer';
                proceedBtn.innerHTML = '<i class="fas fa-arrow-right"></i> Proceed to Categories';
                proceedBtn.style.background = 'var(--gradient-primary)';
                
                // Update field styles to show success
                document.getElementById('voterName').style.borderColor = 'var(--success)';
                document.getElementById('voterEmail').style.borderColor = 'var(--success)';
                
            } else {
                // Disable proceed button
                proceedBtn.disabled = true;
                proceedBtn.style.opacity = '0.5';
                proceedBtn.style.cursor = 'not-allowed';
                proceedBtn.innerHTML = '<i class="fas fa-lock"></i> Complete Required Fields First';
                proceedBtn.style.background = '#6c757d';
            }
        }

        function validateIndividualField(fieldId) {
            const field = document.getElementById(fieldId);
            const value = field.value.trim();
            const validationEl = document.getElementById(fieldId === 'voterName' ? 'nameValidation' : 'emailValidation');
            
            if (fieldId === 'voterName') {
                if (!value || value.length < 2) {
                    showFieldError(field, validationEl, 'Full name is required (minimum 2 characters)');
                } else if (!value.includes(' ')) {
                    showFieldError(field, validationEl, 'Please enter your complete full name (first and last name)');
                } else {
                    showFieldSuccess(field, validationEl);
                }
            } else if (fieldId === 'voterEmail') {
                if (!value) {
                    showFieldError(field, validationEl, 'Email address is required');
                } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)) {
                    showFieldError(field, validationEl, 'Please enter a valid email address');
                } else {
                    showFieldSuccess(field, validationEl);
                }
            }
        }

        function showFieldError(field, validationEl, message) {
            field.style.borderColor = 'var(--danger)';
            field.style.boxShadow = '0 0 0 3px rgba(239, 68, 68, 0.1)';
            validationEl.textContent = '⚠️ ' + message;
            validationEl.style.display = 'block';
            validationEl.style.color = 'var(--danger)';
        }

        function showFieldSuccess(field, validationEl) {
            field.style.borderColor = 'var(--success)';
            field.style.boxShadow = '0 0 0 3px rgba(16, 185, 129, 0.1)';
            validationEl.textContent = '✅ Looks good!';
            validationEl.style.display = 'block';
            validationEl.style.color = 'var(--success)';
        }

        function clearFieldValidation(fieldId) {
            const field = document.getElementById(fieldId);
            const validationEl = document.getElementById(fieldId === 'voterName' ? 'nameValidation' : 'emailValidation');
            
            field.style.borderColor = 'var(--danger)';
            field.style.boxShadow = 'none';
            validationEl.style.display = 'none';
        }

        function loadStoredData() {
            // Load voter information
            const storedVoterInfo = localStorage.getItem('abfc_voter_info');
            if (storedVoterInfo) {
                voterInfo = JSON.parse(storedVoterInfo);
                document.getElementById('voterName').value = voterInfo.voterName || '';
                document.getElementById('voterEmail').value = voterInfo.voterEmail || '';
                
                // Trigger validation for loaded data
                setTimeout(() => {
                    validateVoterForm();
                }, 100);
            }

            // Load individual votes
            const storedVotes = localStorage.getItem('abfc_individual_votes');
            if (storedVotes) {
                votes = JSON.parse(storedVotes);
            }

            // Load all submitted votes
            const storedAllVotes = localStorage.getItem('abfc_all_votes');
            if (storedAllVotes) {
                allVotes = JSON.parse(storedAllVotes);
            }

            // Check if user has voted
            hasVoted = localStorage.getItem('abfc_has_voted') === 'true';
            
            // Load Google Sheets URL
            const storedUrl = localStorage.getItem('abfc_google_sheet_url');
            if (storedUrl) {
                GOOGLE_SHEET_URL = storedUrl;
                document.getElementById('googleSheetUrl').value = storedUrl;
            } else if (GOOGLE_SHEET_URL) {
                // Use the default URL if no stored URL exists
                document.getElementById('googleSheetUrl').value = GOOGLE_SHEET_URL;
                localStorage.setItem('abfc_google_sheet_url', GOOGLE_SHEET_URL);
            }
        }

        function checkVotingStatus() {
            // Less aggressive check - only show if explicitly requested
            if (hasVoted && currentSection === 'welcome') {
                // Don't automatically show success screen, just show welcome with option to reset
                console.log('Previous vote detected, but allowing fresh start');
            }
        }

        // EMERGENCY RESET FUNCTIONS
        function forceResetNow() {
            try {
                console.log('🔧 FORCE RESET initiated...');
                
                // Clear ALL voting-related localStorage
                localStorage.removeItem('abfc_has_voted');
                localStorage.removeItem('abfc_device_id');
                localStorage.removeItem('abfc_individual_votes');
                localStorage.removeItem('abfc_voter_info');
                
                // Reset all variables immediately
                hasVoted = false;
                votes = {};
                voterInfo = {};
                currentCategory = 0;
                currentSection = 'welcome';
                votingEnabled = true;
                
                // Force reset all displays
                document.getElementById('welcomeSection').style.display = 'block';
                document.getElementById('voterCard').classList.remove('show');
                document.getElementById('votingSection').classList.remove('show');
                document.getElementById('successSection').classList.remove('show');
                document.getElementById('progressSection').classList.remove('show');
                document.getElementById('breadcrumb').classList.remove('show');
                document.getElementById('resultsDisplay').classList.remove('show');
                document.getElementById('adminPanel').classList.remove('show');
                
                // Clear all form fields and reset validation
                document.getElementById('voterName').value = '';
                document.getElementById('voterEmail').value = '';
                document.getElementById('votingInput').value = '';
                
                // Reset voter form validation
                resetVoterFormValidation();
                
                // Update progress
                updateRemainingCount();
                updateProgress();
                
                console.log('✅ FORCE RESET completed');
                showToast('🔧 FORCE RESET SUCCESS! You can now vote again.', 'success');
                
                // Force refresh after short delay
                setTimeout(() => {
                    window.location.reload();
                }, 1500);
                
            } catch (error) {
                console.error('Force reset error:', error);
                emergencyWipe();
            }
        }

        function resetVoterFormValidation() {
            // Reset proceed button to disabled state
            const proceedBtn = document.getElementById('proceedBtn');
            proceedBtn.disabled = true;
            proceedBtn.style.opacity = '0.5';
            proceedBtn.style.cursor = 'not-allowed';
            proceedBtn.innerHTML = '<i class="fas fa-lock"></i> Complete Required Fields First';
            proceedBtn.style.background = '#6c757d';
            
            // Reset field styling
            document.getElementById('voterName').style.borderColor = 'var(--danger)';
            document.getElementById('voterEmail').style.borderColor = 'var(--danger)';
            document.getElementById('voterName').style.boxShadow = 'none';
            document.getElementById('voterEmail').style.boxShadow = 'none';
            
            // Hide validation messages
            document.getElementById('nameValidation').style.display = 'none';
            document.getElementById('emailValidation').style.display = 'none';
        }

        function emergencyWipe() {
            console.log('💣 EMERGENCY WIPE initiated...');
            try {
                // Nuclear option - clear everything
                localStorage.clear();
                sessionStorage.clear();
                
                // Reset Google Sheets URL
                const googleUrl = 'https://script.google.com/macros/s/AKfycbwn3z_zCDQih8zdN2quKvX9Brhew_sbyR8DBVvhFe9Z05XhSDRKJhH8b_h4YeTEchhx2w/exec';
                localStorage.setItem('abfc_google_sheet_url', googleUrl);
                
                showToast('💣 EMERGENCY WIPE completed! Reloading...', 'success');
                
                // Force hard reload
                setTimeout(() => {
                    window.location.href = window.location.href.split('#')[0];
                }, 1000);
                
            } catch (error) {
                console.error('Emergency wipe error:', error);
                alert('⚠️ Manual reset needed: Please close this tab and open a fresh one, or try incognito mode.');
            }
        }

        function updateRemainingCount() {
            document.getElementById('remainingCount').textContent = categories.length;
        }

        function startVoting() {
            if (hasVoted) {
                showToast('You have already submitted your vote!', 'warning');
                return;
            }

            if (!votingEnabled) {
                showToast('Voting is currently closed.', 'error');
                return;
            }

            currentSection = 'voter-info';
            document.getElementById('welcomeSection').style.display = 'none';
            document.getElementById('voterCard').classList.add('show');
            document.getElementById('breadcrumb').classList.add('show');
            document.getElementById('breadcrumbText').textContent = 'Voter Registration';
            
            // Focus on name input
            setTimeout(() => {
                document.getElementById('voterName').focus();
            }, 100);
        }

        function proceedToVoting() {
            const voterName = document.getElementById('voterName').value.trim();
            const voterEmail = document.getElementById('voterEmail').value.trim();
            
            // Strict validation with detailed error messages
            let errors = [];
            
            // Validate name
            if (!voterName) {
                errors.push('Full name is required');
            } else if (voterName.length < 2) {
                errors.push('Name must be at least 2 characters long');
            } else if (!voterName.includes(' ')) {
                errors.push('Please enter your complete full name (first and last name)');
            } else if (voterName.length > 100) {
                errors.push('Name is too long (maximum 100 characters)');
            }
            
            // Validate email
            if (!voterEmail) {
                errors.push('Email address is required');
            } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(voterEmail)) {
                errors.push('Please enter a valid email address (example: name@domain.com)');
            } else if (voterEmail.length > 100) {
                errors.push('Email address is too long (maximum 100 characters)');
            }
            
            // If there are errors, show them prominently
            if (errors.length > 0) {
                // Show validation errors for individual fields
                if (voterName && (voterName.length < 2 || !voterName.includes(' '))) {
                    validateIndividualField('voterName');
                }
                if (voterEmail && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(voterEmail)) {
                    validateIndividualField('voterEmail');
                }
                
                // Create a prominent error modal
                const errorMessage = `❌ CANNOT PROCEED TO VOTING\n\nPlease fix these issues:\n\n${errors.map((error, index) => `${index + 1}. ${error}`).join('\n')}\n\nBoth fields are mandatory to participate in ABFC Awards voting.`;
                
                alert(errorMessage);
                
                // Focus on the first problematic field
                if (!voterName || voterName.length < 2 || !voterName.includes(' ')) {
                    document.getElementById('voterName').focus();
                } else {
                    document.getElementById('voterEmail').focus();
                }
                
                // Show a toast notification
                showToast('⚠️ Please complete all required fields with valid information', 'error');
                return;
            }
            
            // Additional check - make sure fields are actually filled
            if (!voterName.trim() || !voterEmail.trim()) {
                alert('❌ BOTH NAME AND EMAIL ARE REQUIRED\n\nYou cannot proceed to voting without providing complete information.');
                return;
            }
            
            // Final validation passed - proceed
            voterInfo.voterName = voterName;
            voterInfo.voterEmail = voterEmail;
            localStorage.setItem('abfc_voter_info', JSON.stringify(voterInfo));

            // Success feedback
            showToast('✅ Information validated! Proceeding to voting categories...', 'success');
            
            // Show voting section
            currentSection = 'voting';
            document.getElementById('voterCard').classList.remove('show');
            document.getElementById('votingSection').classList.add('show');
            document.getElementById('progressSection').classList.add('show');
            document.getElementById('breadcrumbText').textContent = 'Category Voting';
            
            currentCategory = 0;
            updateCategoryDisplay();
            updateProgress();
        }

        function updateCategoryDisplay() {
            const category = categories[currentCategory];
            
            document.getElementById('categoryCounter').textContent = 
                `Category ${currentCategory + 1} of ${categories.length}`;
            document.getElementById('categoryTitle').innerHTML = 
                `<i class="${category.icon}"></i> ${category.title}`;
            document.getElementById('categoryDescription').textContent = category.description;
            
            // Load existing vote
            const existingVote = votes[currentCategory] || '';
            document.getElementById('votingInput').value = existingVote;
            
            // Update navigation buttons
            const prevBtn = document.getElementById('prevButton');
            const nextBtn = document.getElementById('nextButton');
            
            if (currentCategory === 0) {
                prevBtn.style.display = 'none';
            } else {
                prevBtn.style.display = 'inline-flex';
            }
            
            if (currentCategory === categories.length - 1) {
                nextBtn.innerHTML = '<i class="fas fa-check"></i> Submit All Votes';
                nextBtn.className = 'nav-button btn-success';
            } else {
                nextBtn.innerHTML = '<i class="fas fa-arrow-right"></i> Next Category';
                nextBtn.className = 'nav-button btn-primary';
            }

            // Focus on input
            setTimeout(() => {
                document.getElementById('votingInput').focus();
            }, 100);
        }

        function nextCategory() {
            const voteValue = document.getElementById('votingInput').value.trim();
            
            if (!voteValue) {
                showToast('Please enter your vote before continuing.', 'warning');
                document.getElementById('votingInput').focus();
                return;
            }
            
            // Save current vote
            votes[currentCategory] = voteValue;
            localStorage.setItem('abfc_individual_votes', JSON.stringify(votes));
            
            if (currentCategory === categories.length - 1) {
                // Submit all votes
                submitAllVotes();
            } else {
                // Go to next category
                currentCategory++;
                updateCategoryDisplay();
                updateProgress();
            }
        }

        function previousCategory() {
            if (currentCategory > 0) {
                currentCategory--;
                updateCategoryDisplay();
                updateProgress();
            }
        }

        async function submitAllVotes() {
            if (hasVoted) {
                showToast('You have already submitted your votes!', 'error');
                return;
            }

            const nextBtn = document.getElementById('nextButton');
            const originalHTML = nextBtn.innerHTML;
            nextBtn.innerHTML = '<div class="spinner"></div> Submitting...';
            nextBtn.disabled = true;

            try {
                // Enhanced duplicate prevention check
                const deviceId = getDeviceId();
                const voterName = voterInfo.voterName.toLowerCase().trim();
                const voterEmail = voterInfo.voterEmail.toLowerCase().trim();
                
                // Check for existing votes with same device, name, or email
                const existingVote = allVotes.find(vote => 
                    vote.deviceId === deviceId || 
                    vote.voterName.toLowerCase().trim() === voterName ||
                    vote.voterEmail.toLowerCase().trim() === voterEmail
                );
                
                if (existingVote) {
                    const duplicateType = 
                        existingVote.deviceId === deviceId ? 'device' :
                        existingVote.voterName.toLowerCase().trim() === voterName ? 'name' : 'email';
                    
                    console.warn('🚫 Duplicate vote attempt detected:', {
                        type: duplicateType,
                        existing: existingVote,
                        current: { deviceId, voterName, voterEmail }
                    });
                    
                    throw new Error(`Duplicate vote detected: Same ${duplicateType} already voted`);
                }

                // Create vote record with enhanced tracking
                const voteRecord = {
                    timestamp: new Date().toISOString(),
                    deviceId: deviceId,
                    voterName: voterInfo.voterName,
                    voterEmail: voterInfo.voterEmail,
                    votes: {}
                };

                // Map votes to category titles
                categories.forEach((category, index) => {
                    voteRecord.votes[category.title] = votes[index] || '';
                });

                // Submit to Google Sheets if configured
                if (GOOGLE_SHEET_URL) {
                    await fetch(GOOGLE_SHEET_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(voteRecord)
                    });
                    showToast('✅ Vote submitted to Google Sheets successfully!', 'success');
                } else {
                    showToast('⚠️ Google Sheets not configured. Vote saved locally.', 'warning');
                }

                // Save locally as backup
                allVotes.push(voteRecord);
                localStorage.setItem('abfc_all_votes', JSON.stringify(allVotes));
                localStorage.setItem('abfc_has_voted', 'true');
                
                // Create a permanent device lock
                localStorage.setItem('abfc_vote_lock', `${deviceId}_${Date.now()}`);
                
                hasVoted = true;
                
                console.log('✅ Vote submitted successfully:', voteRecord);
                
                // Show success screen after delay
                setTimeout(() => {
                    showSuccessSection();
                }, 1500);

            } catch (error) {
                console.error('❌ Error submitting vote:', error);
                
                if (error.message.includes('Duplicate vote detected')) {
                    showToast('❌ ' + error.message + '. Contact admin if this is an error.', 'error');
                    
                    // Show the admin panel for resolving duplicates
                    setTimeout(() => {
                        const panel = document.getElementById('adminPanel');
                        panel.classList.add('show');
                        if (isAdminAuthenticated) {
                            document.getElementById('adminLogin').style.display = 'none';
                            document.getElementById('adminDashboard').style.display = 'block';
                        }
                    }, 2000);
                } else {
                    showToast('❌ Error submitting to Google Sheets. Vote saved locally as backup.', 'error');
                    
                    // Still save locally
                    const voteRecord = {
                        timestamp: new Date().toISOString(),
                        deviceId: getDeviceId(),
                        voterName: voterInfo.voterName,
                        voterEmail: voterInfo.voterEmail,
                        votes: {...votes}
                    };
                    
                    allVotes.push(voteRecord);
                    localStorage.setItem('abfc_all_votes', JSON.stringify(allVotes));
                    localStorage.setItem('abfc_has_voted', 'true');
                    hasVoted = true;
                    
                    showSuccessSection();
                }
            } finally {
                nextBtn.innerHTML = originalHTML;
                nextBtn.disabled = false;
            }
        }

        function showSuccessSection() {
            currentSection = 'success';
            document.getElementById('votingSection').classList.remove('show');
            document.getElementById('progressSection').classList.remove('show');
            document.getElementById('successSection').classList.add('show');
            document.getElementById('breadcrumbText').textContent = 'Vote Completed';
            
            // Update progress to 100%
            updateProgress();
        }

        function updateProgress() {
            const completedVotes = Object.keys(votes).length;
            const totalCategories = categories.length;
            const percentage = Math.round((completedVotes / totalCategories) * 100);
            const remaining = totalCategories - completedVotes;
            
            document.getElementById('completedCount').textContent = completedVotes;
            document.getElementById('remainingCount').textContent = remaining;
            document.getElementById('progressPercentage').textContent = percentage + '%';
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2500);
        }

        function getDeviceId() {
            let deviceId = localStorage.getItem('abfc_device_id');
            if (!deviceId) {
                // Create a more unique device ID using multiple factors
                const timestamp = Date.now();
                const random = Math.random().toString(36).substr(2, 9);
                const userAgent = navigator.userAgent.replace(/\s+/g, '').substr(0, 20);
                const screenRes = `${screen.width}x${screen.height}`;
                
                deviceId = `abfc_${timestamp}_${random}_${btoa(userAgent + screenRes).substr(0, 8)}`;
                localStorage.setItem('abfc_device_id', deviceId);
                
                console.log('🔧 New device ID created:', deviceId);
            }
            return deviceId;
        }

        // Admin Authentication Functions
        function toggleAdmin(event) {
            event.preventDefault();
            const panel = document.getElementById('adminPanel');
            
            // Check if admin is already authenticated
            if (isAdminAuthenticated) {
                // Show dashboard directly
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                panel.classList.add('show');
                if (panel.classList.contains('show')) {
                    panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
                updateDuplicateStats();
            } else {
                // Show login screen
                document.getElementById('adminLogin').style.display = 'block';
                document.getElementById('adminDashboard').style.display = 'none';
                panel.classList.toggle('show');
                
                if (panel.classList.contains('show')) {
                    panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    // Focus on password field
                    setTimeout(() => {
                        document.getElementById('adminPasscode').focus();
                    }, 300);
                }
            }
        }

        function verifyAdminAccess() {
            const enteredCode = document.getElementById('adminPasscode').value;
            const errorDiv = document.getElementById('adminLoginError');
            
            if (enteredCode === ADMIN_PASSCODE) {
                // Correct passcode
                isAdminAuthenticated = true;
                localStorage.setItem('abfc_admin_session', 'true');
                
                // Hide login, show dashboard
                document.getElementById('adminLogin').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                
                // Clear the password field
                document.getElementById('adminPasscode').value = '';
                errorDiv.style.display = 'none';
                
                showToast('✅ Admin access granted! Welcome to the dashboard.', 'success');
                updateDuplicateStats();
            } else {
                // Wrong passcode
                errorDiv.style.display = 'block';
                document.getElementById('adminPasscode').value = '';
                document.getElementById('adminPasscode').focus();
                showToast('❌ Incorrect admin passcode. Access denied.', 'error');
                
                // Hide error after 5 seconds
                setTimeout(() => {
                    errorDiv.style.display = 'none';
                }, 5000);
            }
        }

        function logoutAdmin() {
            isAdminAuthenticated = false;
            localStorage.removeItem('abfc_admin_session');
            
            // Hide admin panel
            document.getElementById('adminPanel').classList.remove('show');
            
            // Reset to login screen
            document.getElementById('adminLogin').style.display = 'block';
            document.getElementById('adminDashboard').style.display = 'none';
            document.getElementById('adminPasscode').value = '';
            document.getElementById('adminLoginError').style.display = 'none';
            
            showToast('👋 Logged out of admin panel', 'success');
        }

        function closeAdminPanel() {
            document.getElementById('adminPanel').classList.remove('show');
            document.getElementById('adminPasscode').value = '';
            document.getElementById('adminLoginError').style.display = 'none';
        }

        // Duplicate Detection Functions
        function updateDuplicateStats() {
            const totalVotes = allVotes.length;
            const duplicates = findDuplicateVotes();
            
            document.getElementById('totalVotesCount').textContent = totalVotes;
            document.getElementById('duplicateCount').textContent = duplicates.length;
        }

        function findDuplicateVotes() {
            const duplicates = [];
            const seen = new Map();
            
            allVotes.forEach((vote, index) => {
                // Check for duplicates based on multiple criteria
                const deviceKey = vote.deviceId;
                const nameKey = vote.voterName?.toLowerCase().trim();
                const emailKey = vote.voterEmail?.toLowerCase().trim();
                
                // Find potential duplicates
                if (seen.has(deviceKey) || 
                    (nameKey && Array.from(seen.values()).some(v => v.name === nameKey)) ||
                    (emailKey && Array.from(seen.values()).some(v => v.email === emailKey))) {
                    
                    duplicates.push({
                        index: index,
                        vote: vote,
                        reason: seen.has(deviceKey) ? 'Same Device' : 
                               nameKey && Array.from(seen.values()).some(v => v.name === nameKey) ? 'Same Name' : 'Same Email'
                    });
                }
                
                seen.set(deviceKey, {
                    name: nameKey,
                    email: emailKey,
                    timestamp: vote.timestamp
                });
            });
            
            return duplicates;
        }

        function checkForDuplicates() {
            const duplicates = findDuplicateVotes();
            const resultsDiv = document.getElementById('duplicateResults');
            
            if (duplicates.length === 0) {
                resultsDiv.innerHTML = '<div style="color: var(--success); font-weight: 600;">✅ No duplicates found! All votes are unique.</div>';
                resultsDiv.style.display = 'block';
                showToast('✅ No duplicate votes detected', 'success');
                return;
            }
            
            let resultsHTML = `<div style="color: var(--danger); font-weight: 600; margin-bottom: 1rem;">⚠️ Found ${duplicates.length} potential duplicate(s):</div>`;
            
            duplicates.forEach((dup, index) => {
                resultsHTML += `
                    <div style="margin-bottom: 0.5rem; padding: 0.5rem; background: #fef2f2; border-left: 3px solid var(--danger);">
                        <strong>Duplicate #${index + 1}:</strong> ${dup.reason}<br>
                        <small>Name: ${dup.vote.voterName} | Device: ${dup.vote.deviceId} | Time: ${new Date(dup.vote.timestamp).toLocaleString()}</small>
                    </div>
                `;
            });
            
            resultsDiv.innerHTML = resultsHTML;
            resultsDiv.style.display = 'block';
            
            showToast(`⚠️ Found ${duplicates.length} potential duplicates`, 'warning');
        }

        function removeDuplicates() {
            const duplicates = findDuplicateVotes();
            
            if (duplicates.length === 0) {
                showToast('✅ No duplicates to remove', 'success');
                return;
            }
            
            if (confirm(`⚠️ This will remove ${duplicates.length} duplicate vote(s).\n\nDuplicates are determined by:\n• Same device ID\n• Same name\n• Same email\n\nContinue with removal?`)) {
                // Remove duplicates (keep the first occurrence, remove later ones)
                const indicesToRemove = duplicates.map(d => d.index).sort((a, b) => b - a); // Sort descending to remove from end first
                
                indicesToRemove.forEach(index => {
                    allVotes.splice(index, 1);
                });
                
                // Save the cleaned data
                localStorage.setItem('abfc_all_votes', JSON.stringify(allVotes));
                
                // Update stats
                updateDuplicateStats();
                
                // Clear results display
                document.getElementById('duplicateResults').innerHTML = '<div style="color: var(--success); font-weight: 600;">✅ Duplicates removed successfully!</div>';
                
                showToast(`✅ Removed ${indicesToRemove.length} duplicate votes`, 'success');
                
                // Suggest re-export
                setTimeout(() => {
                    if (confirm('💡 Duplicates have been cleaned from local storage.\n\nWould you like to export the cleaned CSV now?')) {
                        exportData();
                    }
                }, 2000);
            }
        }

        function saveGoogleSheetUrl() {
            const url = document.getElementById('googleSheetUrl').value.trim();
            if (!url) {
                showToast('Please enter a valid URL', 'warning');
                return;
            }

            if (!url.includes('script.google.com') || !url.includes('/exec')) {
                showToast('Please enter a valid Google Apps Script URL', 'error');
                return;
            }

            localStorage.setItem('abfc_google_sheet_url', url);
            GOOGLE_SHEET_URL = url;
            updateGoogleSheetsStatus();
            showToast('Google Sheets configuration saved successfully!', 'success');
        }

        function updateGoogleSheetsStatus() {
            const statusEl = document.getElementById('sheetStatus');
            if (GOOGLE_SHEET_URL && GOOGLE_SHEET_URL.includes('script.google.com')) {
                statusEl.innerHTML = '<i class="fas fa-check-circle"></i> Google Sheets connected and ready';
                statusEl.style.color = 'var(--success)';
            } else {
                statusEl.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Google Sheets not configured';
                statusEl.style.color = 'var(--danger)';
            }
        }

        function exportData() {
            if (allVotes.length === 0) {
                showToast('No votes available to export', 'warning');
                return;
            }

            // Clean CSV export
            let csv = 'Timestamp,Device ID,Voter Name,Voter Email,';
            csv += categories.map(cat => cat.title).join(',') + '\n';

            allVotes.forEach(vote => {
                let row = `"${vote.timestamp}","${vote.deviceId}","${vote.voterName}","${vote.voterEmail}",`;
                const voteValues = categories.map(cat => {
                    return `"${vote.votes[cat.title] || ''}"`;
                }).join(',');
                row += voteValues;
                csv += row + '\n';
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ABFC_Awards_Votes_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);

            showToast('📊 CSV exported successfully!', 'success');
        }

        function viewAllResults() {
            if (allVotes.length === 0) {
                showToast('No votes submitted yet. Check your Google Sheet for live results!', 'warning');
                return;
            }

            let results = `AFROBEAT FOOTBALL CLUB - Awards 2025 Results\n`;
            results += `${'='.repeat(50)}\n`;
            results += `Total Votes Recorded: ${allVotes.length}\n`;
            results += `Generated: ${new Date().toLocaleString()}\n\n`;

            categories.forEach((category, index) => {
                results += `${index + 1}. ${category.title}\n`;
                results += `${'-'.repeat(category.title.length + 3)}\n`;

                const voteCounts = {};
                allVotes.forEach(vote => {
                    const userVote = vote.votes[category.title];
                    if (userVote && userVote.trim()) {
                        voteCounts[userVote.trim()] = (voteCounts[userVote.trim()] || 0) + 1;
                    }
                });

                const sortedVotes = Object.entries(voteCounts)
                    .sort((a, b) => b[1] - a[1]);

                if (sortedVotes.length > 0) {
                    sortedVotes.forEach(([player, count], index) => {
                        const medal = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : '  ';
                        results += `  ${medal} ${player}: ${count} vote${count > 1 ? 's' : ''}\n`;
                    });
                } else {
                    results += `  No votes recorded yet\n`;
                }
                results += `\n`;
            });

            results += `\nNote: This shows local backup data only.\n`;
            results += `Check your Google Sheet for complete live results!\n`;
            results += `\nAFROBEAT FC - Excellence • Unity • Victory`;
            
            document.getElementById('resultsContent').textContent = results;
            document.getElementById('resultsDisplay').classList.add('show');
            
            // Scroll to results
            document.getElementById('resultsDisplay').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }

        function clearAllData() {
            if (confirm('⚠️ This will permanently delete ALL voting data and reset the system. Are you sure?')) {
                if (confirm('This action cannot be undone. All votes and voter information will be lost. Continue?')) {
                    localStorage.clear();
                    votes = {};
                    voterInfo = {};
                    allVotes = [];
                    hasVoted = false;
                    currentCategory = 0;
                    currentSection = 'welcome';
                    
                    // Reset display
                    document.getElementById('welcomeSection').style.display = 'block';
                    document.getElementById('voterCard').classList.remove('show');
                    document.getElementById('votingSection').classList.remove('show');
                    document.getElementById('successSection').classList.remove('show');
                    document.getElementById('progressSection').classList.remove('show');
                    document.getElementById('breadcrumb').classList.remove('show');
                    document.getElementById('resultsDisplay').classList.remove('show');
                    document.getElementById('adminPanel').classList.remove('show');
                    
                    // Clear form fields
                    document.getElementById('voterName').value = '';
                    document.getElementById('voterEmail').value = '';
                    document.getElementById('votingInput').value = '';
                    
                    updateRemainingCount();
                    showToast('All data cleared successfully. System reset to initial state.', 'success');
                }
            }
        }

        function toggleVotingStatus() {
            votingEnabled = !votingEnabled;
            const btn = document.getElementById('votingToggle');
            
            if (votingEnabled) {
                btn.innerHTML = '<i class="fas fa-ban"></i> Close Voting';
                btn.className = 'admin-button warning';
                showToast('Voting is now open for all users', 'success');
            } else {
                btn.innerHTML = '<i class="fas fa-play"></i> Open Voting';
                btn.className = 'admin-button info';
                showToast('Voting has been closed', 'warning');
            }
        }

        // Testing and Reset Functions
        function resetForTesting() {
            if (confirm('🧪 Reset for testing? This will:\n• Clear your voting status\n• Keep vote data for reference\n• Allow you to vote again\n\nContinue?')) {
                // Clear voting restrictions but keep data for reference
                localStorage.removeItem('abfc_has_voted');
                localStorage.removeItem('abfc_device_id');
                localStorage.removeItem('abfc_individual_votes');
                localStorage.removeItem('abfc_voter_info');
                
                hasVoted = false;
                votes = {};
                voterInfo = {};
                currentCategory = 0;
                currentSection = 'welcome';
                
                // Reset display to welcome
                document.getElementById('welcomeSection').style.display = 'block';
                document.getElementById('voterCard').classList.remove('show');
                document.getElementById('votingSection').classList.remove('show');
                document.getElementById('successSection').classList.remove('show');
                document.getElementById('progressSection').classList.remove('show');
                document.getElementById('breadcrumb').classList.remove('show');
                document.getElementById('resultsDisplay').classList.remove('show');
                document.getElementById('adminPanel').classList.remove('show');
                
                // Clear form fields
                document.getElementById('voterName').value = '';
                document.getElementById('voterEmail').value = '';
                document.getElementById('votingInput').value = '';
                
                updateRemainingCount();
                updateProgress();
                showToast('🧪 System reset for testing! You can now vote again.', 'success');
            }
        }

        function emergencyClear() {
            if (confirm('🚨 EMERGENCY RESET - This will:\n• Delete EVERYTHING (votes, settings, data)\n• Reset system to factory state\n• Cannot be undone\n\nOnly use if system is broken. Continue?')) {
                if (confirm('⚠️ FINAL WARNING: This will permanently delete all data. Are you absolutely sure?')) {
                    try {
                        // Clear ALL localStorage data
                        localStorage.clear();
                        
                        // Reset all variables
                        votes = {};
                        voterInfo = {};
                        allVotes = [];
                        hasVoted = false;
                        currentCategory = 0;
                        currentSection = 'welcome';
                        votingEnabled = true;
                        
                        // Reset Google Sheets URL to default
                        GOOGLE_SHEET_URL = 'https://script.google.com/macros/s/AKfycbwn3z_zCDQih8zdN2quKvX9Brhew_sbyR8DBVvhFe9Z05XhSDRKJhH8b_h4YeTEchhx2w/exec';
                        localStorage.setItem('abfc_google_sheet_url', GOOGLE_SHEET_URL);
                        
                        // Force reload the page
                        showToast('🚨 Emergency reset complete. Reloading page...', 'success');
                        setTimeout(() => {
                            window.location.reload();
                        }, 2000);
                        
                    } catch (error) {
                        console.error('Emergency clear error:', error);
                        showToast('❌ Emergency reset failed. Please reload page manually.', 'error');
                    }
                }
            }
        }

        // Sharing Functions
        function shareWhatsApp() {
            const url = window.location.href;
            const text = encodeURIComponent(`🏆 AFROBEAT FOOTBALL CLUB Awards 2025 - Official Voting!\n\n⚽ Cast your vote for our club's finest players\n🎯 9 prestigious categories to vote on\n✅ Quick & secure voting process\n\nVote now: ${url}\n\nAFROBEAT FC - Excellence • Unity • Victory 🏆`);
            window.open(`https://wa.me/?text=${text}`, '_blank');
        }

        function copyLink() {
            const url = window.location.href;
            if (navigator.clipboard) {
                navigator.clipboard.writeText(url).then(() => {
                    showToast('Voting link copied to clipboard! Share it with the team.', 'success');
                });
            } else {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = url;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast('Voting link copied to clipboard!', 'success');
            }
        }

        function shareResults() {
            const url = window.location.href;
            const text = encodeURIComponent(`🎉 AFROBEAT FC Awards 2025 Results Are In!\n\n🏆 See who won our prestigious club awards\n⭐ Celebrating our season's best performances\n🎖️ Thank you to everyone who voted!\n\nView results: ${url}\n\nAFROBEAT FC - Excellence • Unity • Victory 🏆`);
            window.open(`https://wa.me/?text=${text}`, '_blank');
        }

        function viewResults() {
            viewAllResults();
        }

        // Utility Functions
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icon = type === 'success' ? 'fa-check-circle' : 
                        type === 'warning' ? 'fa-exclamation-triangle' : 
                        'fa-times-circle';
                        
            toast.innerHTML = `<i class="fas ${icon}"></i> ${message}`;
            document.body.appendChild(toast);

            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 400);
            }, 4000);
        }
    </script>
</body>
</html>
